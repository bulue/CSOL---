using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Threading;
using System.IO;
using System.Text.RegularExpressions;
using System.Runtime.InteropServices;
using System.Diagnostics;
using Microsoft.Win32;
using System.Net;
using System.Xml;
using System.Security.Cryptography;
using CommonQ;
using System.Net.Sockets;

namespace CSLogin
{
    public partial class csLoginTool : Form
    {

#region Member
        static private csLoginTool instance = null;
        private Thread _logicThread = null;
        public IniFile _iniFile = new IniFile(@".\config.ini");
        private LoginManage _loginManage = null;
        bool _bAutoStart = false;
        bool _bUpdate = true;
#endregion

#region API
        [DllImport("user32.dll")]
        private static extern int RegisterHotKey(IntPtr hwnd, int id, int fsModifiers, int vk);
        [DllImport("user32.dll")]
        private static extern int UnregisterHotKey(IntPtr hwnd, int id);
        int Space = 32; //热键ID
        private const int WM_HOTKEY = 0x312; //窗口消息-热键
        private const int WM_CREATE = 0x1; //窗口消息-创建
        private const int WM_DESTROY = 0x2; //窗口消息-销毁
        private const int MOD_ALT = 0x1; //ALT
        private const int MOD_CONTROL = 0x2; //CTRL
        private const int MOD_SHIFT = 0x4; //SHIFT
        private const int VK_SPACE = 0x20; //SPACE
        private const int VK_F12 = 123;


        /// <summary>
        /// 注册热键
        /// </summary>
        /// <param name="hwnd">窗口句柄</param>
        /// <param name="hotKey_id">热键ID</param>
        /// <param name="fsModifiers">组合键</param>
        /// <param name="vk">热键</param>
        private void RegKey(IntPtr hwnd, int hotKey_id, int fsModifiers, int vk)
        {
            bool result;
            if (RegisterHotKey(hwnd, hotKey_id, fsModifiers, vk) == 0)
            {
                result = false;
            }
            else
            {
                result = true;
            }
            if (!result)
            {
                MessageBox.Show("注册热键失败！");
            }
        }
        /// <summary>
        /// 注销热键
        /// </summary>
        /// <param name="hwnd">窗口句柄</param>
        /// <param name="hotKey_id">热键ID</param>
        private void UnRegKey(IntPtr hwnd, int hotKey_id)
        {
            UnregisterHotKey(hwnd, hotKey_id);
        }
#endregion
        public static string GamePath = "";
        static public Dictionary<string, string> Lg = new Dictionary<string, string>();
        Thread m_RoutieThread = null;

        private void Init()
        {
            Text += string.Format(" {0:yy-MM-dd HH:mm:ss} Version {1}.{2}.{3}"
                , System.IO.File.GetLastWriteTime(this.GetType().Assembly.Location)
                , System.Reflection.Assembly.GetExecutingAssembly().GetName().Version.Major
                , System.Reflection.Assembly.GetExecutingAssembly().GetName().Version.Minor
                , System.Reflection.Assembly.GetExecutingAssembly().GetName().Version.Build);

            _loginManage = new LoginManage(this);

            //System.Diagnostics.Process.Start("regsvr32", @"/s xiaoai.dll");

            this.gamePath.Text = _iniFile.IniReadValue("UI", "gamePath");

            textBox_Code.Text = _iniFile.IniReadValue("UI", "code");
            textBox_IP.Text = _iniFile.IniReadValue("UI", "manageIp");

            if (textBox_Code.Text == "")
            {
                textBox_Code.Text = "<默认>" + "1号机";
                _loginManage.m_Code = textBox_Code.Text;
            }
            else
            {
                _loginManage.m_Code = textBox_Code.Text;
            }

            if (textBox_IP.Text == "")
            {
                string hostname = Dns.GetHostName();
                IPHostEntry localhost = Dns.GetHostByName(hostname);
                IPAddress localaddr = localhost.AddressList[0];
                string IP = localaddr.ToString();
                _loginManage.m_ManageIp = IP;
                textBox_IP.Text = IP;
            }
            else
            {
                _loginManage.m_ManageIp = textBox_IP.Text;
            }

            autostartTimer.Interval = 2000;
            autostartTimer.Start();

            rebootTimer.Interval = 1000;

            string autoStart = _iniFile.IniReadValue("Other", "autoStart");
            if (autoStart == "1")
            {
                this.autoStartCkbox.Checked = true;
            }
            else
            {

            }

            Global.logger = CLogger.FromFolder("log/cslog");
            Global.logger.SetShowLogFunction(ShowLogFunc);
        }

        public void ShowLogFunc(eLoggerLevel l,string s)
        {
            if (this.InvokeRequired)
            {
                this.BeginInvoke(new Action<eLoggerLevel,string>(ShowLogFunc),l,s);
            }
            else
            {
                textBox.Text += s;
                textBox.Text += "\r\n";
                if (textBox.Text.Length > 2000)
                {
                    textBox.Text = "";
                }
            }
        }

        protected override void OnLoad(EventArgs e)
        {
            base.OnLoad(e);
        }

        public csLoginTool(bool bAutoStart, bool boUpdate)
        {
            InitializeComponent();
            Init();
            
            _bAutoStart = bAutoStart;
            if (_bAutoStart)
            {
                this.WindowState = FormWindowState.Minimized;
            }
            _bUpdate = boUpdate;

            instance = this;
        }

        static public csLoginTool Instance
        {
            get 
            {
                return instance;
            }
        }

        protected override void WndProc(ref Message m)
        {
            base.WndProc(ref m);
            switch (m.Msg)
            {
                case WM_HOTKEY: //窗口消息-热键
                    switch (m.WParam.ToInt32())
                    {
                        case 32: //热键ID
                            PauseBtn_Click(null, null);
                            break;
                        default:
                            break;
                    }
                    break;
                case WM_CREATE: //窗口消息-创建
                    RegKey(Handle, Space,MOD_CONTROL, VK_F12); //注册热键
                    break;
                case WM_DESTROY: //窗口消息-销毁
                    UnRegKey(Handle, Space); //销毁热键
                    break;
                default:
                    break;
            }
        }

        private void startBtn_Click(object sender, EventArgs e)
        {
            StartLogin();
        }

        private void StartLogin()
        {
            GamePath = this.gamePath.Text;
            if (_logicThread != null)
            {
                MessageBox.Show("线程已经启动了!!");
                return;
            }

            if (_logicThread == null)
            {
                _logicThread = new Thread(new ThreadStart(_loginManage.Run));
            }

            if (!_logicThread.IsAlive)
            {
                _logicThread.Start();
            }
        }

        protected override void OnClosed(EventArgs e)
        {
            if (_logicThread != null && _logicThread.IsAlive)
            {
                _logicThread.Abort();
                _logicThread = null;
            }
            base.OnClosed(e);
        }

        private void gamePathPickBtn_Click(object sender, EventArgs e)
        {
            OpenFileDialog dialog = new OpenFileDialog();
            dialog.Title = "选择CSOLauncher.exe";
            dialog.Filter = "游戏(*.exe)|*.exe";

            if (dialog.ShowDialog() == DialogResult.OK)
            {
                this.gamePath.Text = dialog.FileName;
                _iniFile.IniWriteValue("UI", "gamePath", this.gamePath.Text);
            }
        }

        public string getGamePath()
        {
            return this.gamePath.Text;
        }

        private void PauseBtn_Click(object sender, EventArgs e)
        {
            if (_logicThread == null)
            {
                MessageBox.Show("登陆器还没有启动");
                return;
            }

            if (LoginManage.isStop)
            {
                LoginManage.isStop = false;
                PauseBtn.Text = "暂停 Ctrl+f12";
            }
            else
            {
                LoginManage.isStop = true;
                PauseBtn.Text = "恢复 Ctrl+f12";
            }
        }

        public static void RegAutoStart(bool reg,bool showDialg = false)
        {
            if (reg)
            {
                string starupPath = Application.ExecutablePath;
                try
                {
                    RegistryKey loca = Registry.LocalMachine;
                    RegistryKey run = loca.CreateSubKey(@"SOFTWARE\Microsoft\Windows\CurrentVersion\Run\");

                    if (run.GetValue("WinForm") as string != starupPath + @" -autostart")
                    {
                        run.SetValue("WinForm", starupPath + @" -autostart");
                        //MessageBox.Show("成功设置开机启动!!", "提示", MessageBoxButtons.OK, MessageBoxIcon.Information);
                    }
                    loca.Close();
                    run.Close();

                }
                catch (Exception ee)
                {
                    if (showDialg)
                    {
                        MessageBox.Show(ee.Message.ToString(), "提示", MessageBoxButtons.OK, MessageBoxIcon.Error);
                    }
                }
            }
            else
            {
                try
                {
                    RegistryKey loca = Registry.LocalMachine;
                    RegistryKey run = loca.CreateSubKey(@"SOFTWARE\Microsoft\Windows\CurrentVersion\Run\");
                    run.DeleteValue("WinForm");

                    loca.Close();
                    run.Close();

                    MessageBox.Show("已经关闭开机启动!!", "提示", MessageBoxButtons.OK, MessageBoxIcon.Information);
                }
                catch (System.Exception ex)
                {
                    if (showDialg)
                    {
                        MessageBox.Show(ex.Message.ToString(), "提示", MessageBoxButtons.OK, MessageBoxIcon.Error);
                    }
                }
            }
        }

        private void autoStartCkbox_CheckedChanged(object sender, EventArgs e)
        {
            if (autoStartCkbox.Checked)
            {
                RegAutoStart(true,true);       //注册开机自动重启
                _iniFile.IniWriteValue("Other", "autoStart", "1");
            }
            else
            {
                RegAutoStart(false,true);
                _iniFile.IniWriteValue("Other", "autoStart", "0");
            }
        }

        private void autostartTime(object sender, EventArgs e)
        {
            if (_bAutoStart)
            {
                Global.logger.Info("========开始启动自动登陆========");
                StartLogin();
            }
            this.autostartTimer.Stop();
        }

        private void SetCodeBtn_Click(object sender, EventArgs e)
        {
            string s = textBox_Code.Text;
            _loginManage.m_Code = s;
            _iniFile.IniWriteValue("UI", "code", s);

            MessageBox.Show("修改成功");
        }

        private void SetManageIpBtn_Click(object sender, EventArgs e)
        {
            string s = textBox_IP.Text;
            _loginManage.m_ManageIp = s;
            _iniFile.IniWriteValue("UI", "manageIp", s);

            MessageBox.Show("修改成功");
        }

        public void OnMsg(string s)
        {
            _loginManage.OnMsg(s);
        }

        protected override void OnClosing(CancelEventArgs e)
        {
            try
            {
                if (_loginManage.thread != null)
                    _loginManage.thread.Abort();
                if (m_RoutieThread != null)
                    m_RoutieThread.Abort();
                CLogger.StopAllLoggers();
            }
            catch (System.Exception ex)
            {
            	
            }
            base.OnClosing(e);
        }

        const string update_app = "update_v1.exe";

        private void csLoginTool_Load(object sender, EventArgs e)
        {
            if (_bUpdate)
            {
                if (File.Exists(update_app))
                {
                    Process.Start(update_app, "-autostart -autoclose");
                    Environment.Exit(0);
                }
                else
                {
                    Global.logger.Debug("update 不存在,不执行更新");
                }
            }
            tbxMac.Text = CommonApi.GetMacAddress();
            if (File.Exists("conf"))
            {
               string s = ByteDes.Decode(File.ReadAllBytes("conf"));
               XmlDocument doc = new XmlDocument();
               doc.LoadXml(s);

               XmlNode root = doc.SelectSingleNode("Data");
               for (XmlNode item = root.FirstChild; item != null; item = item.NextSibling)
               {
                   string name = item.Attributes["name"].Value;
                   string value = item.Attributes["value"].Value;
                   Lg.Add(name, value);
               }
            }

            m_RoutieThread = new Thread(new ThreadStart(delegate()
            {
                try
                {
                    byte[] recv = new byte[10024];

                    Socket socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
                    socket.Connect("192.168.0.1", 80);
                    socket.Send(connectData);

                    socket.Receive(recv);
                    Console.WriteLine(System.Text.Encoding.UTF8.GetString(recv));
                    socket.Receive(recv);
                    Console.WriteLine(System.Text.Encoding.UTF8.GetString(recv));
                }
                catch (System.Exception ex)
                {
                    Global.logger.Debug("启动腾达路由重连接:" + ex.ToString());
                }
            }));
            m_RoutieThread.Start();
        }

        #region
        byte[] loginData = {
0x50, 0x4f, 0x53, 0x54, 0x20, 0x2f, 0x4c, 0x6f, 
0x67, 0x69, 0x6e, 0x43, 0x68, 0x65, 0x63, 0x6b, 
0x20, 0x48, 0x54, 0x54, 0x50, 0x2f, 0x31, 0x2e, 
0x31, 0x0d, 0x0a, 0x41, 0x63, 0x63, 0x65, 0x70, 
0x74, 0x3a, 0x20, 0x74, 0x65, 0x78, 0x74, 0x2f, 
0x68, 0x74, 0x6d, 0x6c, 0x2c, 0x20, 0x61, 0x70, 
0x70, 0x6c, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 
0x6e, 0x2f, 0x78, 0x68, 0x74, 0x6d, 0x6c, 0x2b, 
0x78, 0x6d, 0x6c, 0x2c, 0x20, 0x2a, 0x2f, 0x2a, 
0x0d, 0x0a, 0x52, 0x65, 0x66, 0x65, 0x72, 0x65, 
0x72, 0x3a, 0x20, 0x68, 0x74, 0x74, 0x70, 0x3a, 
0x2f, 0x2f, 0x31, 0x39, 0x32, 0x2e, 0x31, 0x36, 
0x38, 0x2e, 0x30, 0x2e, 0x31, 0x2f, 0x6c, 0x6f, 
0x67, 0x69, 0x6e, 0x2e, 0x61, 0x73, 0x70, 0x0d, 
0x0a, 0x41, 0x63, 0x63, 0x65, 0x70, 0x74, 0x2d, 
0x4c, 0x61, 0x6e, 0x67, 0x75, 0x61, 0x67, 0x65, 
0x3a, 0x20, 0x7a, 0x68, 0x2d, 0x43, 0x4e, 0x0d, 
0x0a, 0x55, 0x73, 0x65, 0x72, 0x2d, 0x41, 0x67, 
0x65, 0x6e, 0x74, 0x3a, 0x20, 0x4d, 0x6f, 0x7a, 
0x69, 0x6c, 0x6c, 0x61, 0x2f, 0x35, 0x2e, 0x30, 
0x20, 0x28, 0x63, 0x6f, 0x6d, 0x70, 0x61, 0x74, 
0x69, 0x62, 0x6c, 0x65, 0x3b, 0x20, 0x4d, 0x53, 
0x49, 0x45, 0x20, 0x39, 0x2e, 0x30, 0x3b, 0x20, 
0x57, 0x69, 0x6e, 0x64, 0x6f, 0x77, 0x73, 0x20, 
0x4e, 0x54, 0x20, 0x36, 0x2e, 0x31, 0x3b, 0x20, 
0x57, 0x4f, 0x57, 0x36, 0x34, 0x3b, 0x20, 0x54, 
0x72, 0x69, 0x64, 0x65, 0x6e, 0x74, 0x2f, 0x35, 
0x2e, 0x30, 0x29, 0x0d, 0x0a, 0x43, 0x6f, 0x6e, 
0x74, 0x65, 0x6e, 0x74, 0x2d, 0x54, 0x79, 0x70, 
0x65, 0x3a, 0x20, 0x61, 0x70, 0x70, 0x6c, 0x69, 
0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x2f, 0x78, 
0x2d, 0x77, 0x77, 0x77, 0x2d, 0x66, 0x6f, 0x72, 
0x6d, 0x2d, 0x75, 0x72, 0x6c, 0x65, 0x6e, 0x63, 
0x6f, 0x64, 0x65, 0x64, 0x0d, 0x0a, 0x41, 0x63, 
0x63, 0x65, 0x70, 0x74, 0x2d, 0x45, 0x6e, 0x63, 
0x6f, 0x64, 0x69, 0x6e, 0x67, 0x3a, 0x20, 0x67, 
0x7a, 0x69, 0x70, 0x2c, 0x20, 0x64, 0x65, 0x66, 
0x6c, 0x61, 0x74, 0x65, 0x0d, 0x0a, 0x48, 0x6f, 
0x73, 0x74, 0x3a, 0x20, 0x31, 0x39, 0x32, 0x2e, 
0x31, 0x36, 0x38, 0x2e, 0x30, 0x2e, 0x31, 0x0d, 
0x0a, 0x43, 0x6f, 0x6e, 0x74, 0x65, 0x6e, 0x74, 
0x2d, 0x4c, 0x65, 0x6e, 0x67, 0x74, 0x68, 0x3a, 
0x20, 0x34, 0x32, 0x0d, 0x0a, 0x43, 0x6f, 0x6e, 
0x6e, 0x65, 0x63, 0x74, 0x69, 0x6f, 0x6e, 0x3a, 
0x20, 0x4b, 0x65, 0x65, 0x70, 0x2d, 0x41, 0x6c, 
0x69, 0x76, 0x65, 0x0d, 0x0a, 0x43, 0x61, 0x63, 
0x68, 0x65, 0x2d, 0x43, 0x6f, 0x6e, 0x74, 0x72, 
0x6f, 0x6c, 0x3a, 0x20, 0x6e, 0x6f, 0x2d, 0x63, 
0x61, 0x63, 0x68, 0x65, 0x0d, 0x0a, 0x0d, 0x0a, 
0x55, 0x73, 0x65, 0x72, 0x6e, 0x61, 0x6d, 0x65, 
0x3d, 0x61, 0x64, 0x6d, 0x69, 0x6e, 0x26, 0x63, 
0x68, 0x65, 0x63, 0x6b, 0x45, 0x6e, 0x3d, 0x30, 
0x26, 0x50, 0x61, 0x73, 0x73, 0x77, 0x6f, 0x72, 
0x64, 0x3d, 0x61, 0x73, 0x64, 0x31, 0x32, 0x33, 
0x35, 0x38 };


        byte[] disconnectData = {
0x50, 0x4f, 0x53, 0x54, 0x20, 0x2f, 0x67, 0x6f, 
0x66, 0x6f, 0x72, 0x6d, 0x2f, 0x53, 0x79, 0x73, 
0x53, 0x74, 0x61, 0x74, 0x75, 0x73, 0x48, 0x61, 
0x6e, 0x64, 0x6c, 0x65, 0x20, 0x48, 0x54, 0x54, 
0x50, 0x2f, 0x31, 0x2e, 0x31, 0x0d, 0x0a, 0x41, 
0x63, 0x63, 0x65, 0x70, 0x74, 0x3a, 0x20, 0x74, 
0x65, 0x78, 0x74, 0x2f, 0x68, 0x74, 0x6d, 0x6c, 
0x2c, 0x20, 0x61, 0x70, 0x70, 0x6c, 0x69, 0x63, 
0x61, 0x74, 0x69, 0x6f, 0x6e, 0x2f, 0x78, 0x68, 
0x74, 0x6d, 0x6c, 0x2b, 0x78, 0x6d, 0x6c, 0x2c, 
0x20, 0x2a, 0x2f, 0x2a, 0x0d, 0x0a, 0x52, 0x65, 
0x66, 0x65, 0x72, 0x65, 0x72, 0x3a, 0x20, 0x68, 
0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x31, 0x39, 
0x32, 0x2e, 0x31, 0x36, 0x38, 0x2e, 0x30, 0x2e, 
0x31, 0x2f, 0x73, 0x79, 0x73, 0x74, 0x65, 0x6d, 
0x5f, 0x73, 0x74, 0x61, 0x74, 0x75, 0x73, 0x2e, 
0x61, 0x73, 0x70, 0x0d, 0x0a, 0x41, 0x63, 0x63, 
0x65, 0x70, 0x74, 0x2d, 0x4c, 0x61, 0x6e, 0x67, 
0x75, 0x61, 0x67, 0x65, 0x3a, 0x20, 0x7a, 0x68, 
0x2d, 0x43, 0x4e, 0x0d, 0x0a, 0x55, 0x73, 0x65, 
0x72, 0x2d, 0x41, 0x67, 0x65, 0x6e, 0x74, 0x3a, 
0x20, 0x4d, 0x6f, 0x7a, 0x69, 0x6c, 0x6c, 0x61, 
0x2f, 0x35, 0x2e, 0x30, 0x20, 0x28, 0x63, 0x6f, 
0x6d, 0x70, 0x61, 0x74, 0x69, 0x62, 0x6c, 0x65, 
0x3b, 0x20, 0x4d, 0x53, 0x49, 0x45, 0x20, 0x39, 
0x2e, 0x30, 0x3b, 0x20, 0x57, 0x69, 0x6e, 0x64, 
0x6f, 0x77, 0x73, 0x20, 0x4e, 0x54, 0x20, 0x36, 
0x2e, 0x31, 0x3b, 0x20, 0x57, 0x4f, 0x57, 0x36, 
0x34, 0x3b, 0x20, 0x54, 0x72, 0x69, 0x64, 0x65, 
0x6e, 0x74, 0x2f, 0x35, 0x2e, 0x30, 0x29, 0x0d, 
0x0a, 0x43, 0x6f, 0x6e, 0x74, 0x65, 0x6e, 0x74, 
0x2d, 0x54, 0x79, 0x70, 0x65, 0x3a, 0x20, 0x61, 
0x70, 0x70, 0x6c, 0x69, 0x63, 0x61, 0x74, 0x69, 
0x6f, 0x6e, 0x2f, 0x78, 0x2d, 0x77, 0x77, 0x77, 
0x2d, 0x66, 0x6f, 0x72, 0x6d, 0x2d, 0x75, 0x72, 
0x6c, 0x65, 0x6e, 0x63, 0x6f, 0x64, 0x65, 0x64, 
0x0d, 0x0a, 0x41, 0x63, 0x63, 0x65, 0x70, 0x74, 
0x2d, 0x45, 0x6e, 0x63, 0x6f, 0x64, 0x69, 0x6e, 
0x67, 0x3a, 0x20, 0x67, 0x7a, 0x69, 0x70, 0x2c, 
0x20, 0x64, 0x65, 0x66, 0x6c, 0x61, 0x74, 0x65, 
0x0d, 0x0a, 0x48, 0x6f, 0x73, 0x74, 0x3a, 0x20, 
0x31, 0x39, 0x32, 0x2e, 0x31, 0x36, 0x38, 0x2e, 
0x30, 0x2e, 0x31, 0x0d, 0x0a, 0x43, 0x6f, 0x6e, 
0x74, 0x65, 0x6e, 0x74, 0x2d, 0x4c, 0x65, 0x6e, 
0x67, 0x74, 0x68, 0x3a, 0x20, 0x34, 0x31, 0x0d, 
0x0a, 0x43, 0x6f, 0x6e, 0x6e, 0x65, 0x63, 0x74, 
0x69, 0x6f, 0x6e, 0x3a, 0x20, 0x4b, 0x65, 0x65, 
0x70, 0x2d, 0x41, 0x6c, 0x69, 0x76, 0x65, 0x0d, 
0x0a, 0x43, 0x61, 0x63, 0x68, 0x65, 0x2d, 0x43, 
0x6f, 0x6e, 0x74, 0x72, 0x6f, 0x6c, 0x3a, 0x20, 
0x6e, 0x6f, 0x2d, 0x63, 0x61, 0x63, 0x68, 0x65, 
0x0d, 0x0a, 0x43, 0x6f, 0x6f, 0x6b, 0x69, 0x65, 
0x3a, 0x20, 0x6c, 0x61, 0x6e, 0x67, 0x75, 0x61, 
0x67, 0x65, 0x3d, 0x63, 0x6e, 0x3b, 0x20, 0x61, 
0x64, 0x6d, 0x69, 0x6e, 0x3a, 0x6c, 0x61, 0x6e, 
0x67, 0x75, 0x61, 0x67, 0x65, 0x3d, 0x63, 0x6e, 
0x0d, 0x0a, 0x0d, 0x0a, 0x43, 0x4d, 0x44, 0x3d, 
0x57, 0x41, 0x4e, 0x5f, 0x43, 0x4f, 0x4e, 0x26, 
0x47, 0x4f, 0x3d, 0x73, 0x79, 0x73, 0x74, 0x65, 
0x6d, 0x5f, 0x73, 0x74, 0x61, 0x74, 0x75, 0x73, 
0x2e, 0x61, 0x73, 0x70, 0x26, 0x61, 0x63, 0x74, 
0x69, 0x6f, 0x6e, 0x3d, 0x34 };


        byte[] connectData = {
0x50, 0x4f, 0x53, 0x54, 0x20, 0x2f, 0x67, 0x6f, 
0x66, 0x6f, 0x72, 0x6d, 0x2f, 0x53, 0x79, 0x73, 
0x53, 0x74, 0x61, 0x74, 0x75, 0x73, 0x48, 0x61, 
0x6e, 0x64, 0x6c, 0x65, 0x20, 0x48, 0x54, 0x54, 
0x50, 0x2f, 0x31, 0x2e, 0x31, 0x0d, 0x0a, 0x41, 
0x63, 0x63, 0x65, 0x70, 0x74, 0x3a, 0x20, 0x74, 
0x65, 0x78, 0x74, 0x2f, 0x68, 0x74, 0x6d, 0x6c, 
0x2c, 0x20, 0x61, 0x70, 0x70, 0x6c, 0x69, 0x63, 
0x61, 0x74, 0x69, 0x6f, 0x6e, 0x2f, 0x78, 0x68, 
0x74, 0x6d, 0x6c, 0x2b, 0x78, 0x6d, 0x6c, 0x2c, 
0x20, 0x2a, 0x2f, 0x2a, 0x0d, 0x0a, 0x52, 0x65, 
0x66, 0x65, 0x72, 0x65, 0x72, 0x3a, 0x20, 0x68, 
0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x31, 0x39, 
0x32, 0x2e, 0x31, 0x36, 0x38, 0x2e, 0x30, 0x2e, 
0x31, 0x2f, 0x73, 0x79, 0x73, 0x74, 0x65, 0x6d, 
0x5f, 0x73, 0x74, 0x61, 0x74, 0x75, 0x73, 0x2e, 
0x61, 0x73, 0x70, 0x0d, 0x0a, 0x41, 0x63, 0x63, 
0x65, 0x70, 0x74, 0x2d, 0x4c, 0x61, 0x6e, 0x67, 
0x75, 0x61, 0x67, 0x65, 0x3a, 0x20, 0x7a, 0x68, 
0x2d, 0x43, 0x4e, 0x0d, 0x0a, 0x55, 0x73, 0x65, 
0x72, 0x2d, 0x41, 0x67, 0x65, 0x6e, 0x74, 0x3a, 
0x20, 0x4d, 0x6f, 0x7a, 0x69, 0x6c, 0x6c, 0x61, 
0x2f, 0x35, 0x2e, 0x30, 0x20, 0x28, 0x63, 0x6f, 
0x6d, 0x70, 0x61, 0x74, 0x69, 0x62, 0x6c, 0x65, 
0x3b, 0x20, 0x4d, 0x53, 0x49, 0x45, 0x20, 0x39, 
0x2e, 0x30, 0x3b, 0x20, 0x57, 0x69, 0x6e, 0x64, 
0x6f, 0x77, 0x73, 0x20, 0x4e, 0x54, 0x20, 0x36, 
0x2e, 0x31, 0x3b, 0x20, 0x57, 0x4f, 0x57, 0x36, 
0x34, 0x3b, 0x20, 0x54, 0x72, 0x69, 0x64, 0x65, 
0x6e, 0x74, 0x2f, 0x35, 0x2e, 0x30, 0x29, 0x0d, 
0x0a, 0x43, 0x6f, 0x6e, 0x74, 0x65, 0x6e, 0x74, 
0x2d, 0x54, 0x79, 0x70, 0x65, 0x3a, 0x20, 0x61, 
0x70, 0x70, 0x6c, 0x69, 0x63, 0x61, 0x74, 0x69, 
0x6f, 0x6e, 0x2f, 0x78, 0x2d, 0x77, 0x77, 0x77, 
0x2d, 0x66, 0x6f, 0x72, 0x6d, 0x2d, 0x75, 0x72, 
0x6c, 0x65, 0x6e, 0x63, 0x6f, 0x64, 0x65, 0x64, 
0x0d, 0x0a, 0x41, 0x63, 0x63, 0x65, 0x70, 0x74, 
0x2d, 0x45, 0x6e, 0x63, 0x6f, 0x64, 0x69, 0x6e, 
0x67, 0x3a, 0x20, 0x67, 0x7a, 0x69, 0x70, 0x2c, 
0x20, 0x64, 0x65, 0x66, 0x6c, 0x61, 0x74, 0x65, 
0x0d, 0x0a, 0x48, 0x6f, 0x73, 0x74, 0x3a, 0x20, 
0x31, 0x39, 0x32, 0x2e, 0x31, 0x36, 0x38, 0x2e, 
0x30, 0x2e, 0x31, 0x0d, 0x0a, 0x43, 0x6f, 0x6e, 
0x74, 0x65, 0x6e, 0x74, 0x2d, 0x4c, 0x65, 0x6e, 
0x67, 0x74, 0x68, 0x3a, 0x20, 0x34, 0x31, 0x0d, 
0x0a, 0x43, 0x6f, 0x6e, 0x6e, 0x65, 0x63, 0x74, 
0x69, 0x6f, 0x6e, 0x3a, 0x20, 0x4b, 0x65, 0x65, 
0x70, 0x2d, 0x41, 0x6c, 0x69, 0x76, 0x65, 0x0d, 
0x0a, 0x43, 0x61, 0x63, 0x68, 0x65, 0x2d, 0x43, 
0x6f, 0x6e, 0x74, 0x72, 0x6f, 0x6c, 0x3a, 0x20, 
0x6e, 0x6f, 0x2d, 0x63, 0x61, 0x63, 0x68, 0x65, 
0x0d, 0x0a, 0x43, 0x6f, 0x6f, 0x6b, 0x69, 0x65, 
0x3a, 0x20, 0x6c, 0x61, 0x6e, 0x67, 0x75, 0x61, 
0x67, 0x65, 0x3d, 0x63, 0x6e, 0x3b, 0x20, 0x61, 
0x64, 0x6d, 0x69, 0x6e, 0x3a, 0x6c, 0x61, 0x6e, 
0x67, 0x75, 0x61, 0x67, 0x65, 0x3d, 0x63, 0x6e, 
0x0d, 0x0a, 0x0d, 0x0a, 0x43, 0x4d, 0x44, 0x3d, 
0x57, 0x41, 0x4e, 0x5f, 0x43, 0x4f, 0x4e, 0x26, 
0x47, 0x4f, 0x3d, 0x73, 0x79, 0x73, 0x74, 0x65, 
0x6d, 0x5f, 0x73, 0x74, 0x61, 0x74, 0x75, 0x73, 
0x2e, 0x61, 0x73, 0x70, 0x26, 0x61, 0x63, 0x74, 
0x69, 0x6f, 0x6e, 0x3d, 0x33 };
        #endregion
    }

}
